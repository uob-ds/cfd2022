
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Handling Pandas safely &#8212; Coding for Data - 2022 edition</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://uob-ds.github.io/cfd2022/wild-pandas/safe_pandas.html" />
    <link rel="shortcut icon" href="../_static/dsfe_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Storing and loading text" href="text_encoding.html" />
    <link rel="prev" title="Noble politics and comparing counts" href="noble_politics.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/dsfe_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Coding for Data - 2022 edition</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Coding for data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/what-is-data-science.html">
   What is data science?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/why-data-science.html">
   Why Data Science?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/tools_techniques.html">
   Tools and techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/computational-tools.html">
     Computational Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/statistical-techniques.html">
     Statistical Techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/text-is-data.html">
   Text is data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Plotting_the_Classics.html">
     Plotting the classics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Literary_Characters.html">
     Literary characters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Another_Kind_Of_Character.html">
     Another kind of character
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/surviving_computers.html">
   Surviving the computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/the_software.html">
   Our tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/using_jupyter.html">
   Using Jupyter notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/more_on_jupyter.html">
   More on the Jupyter notebook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  On code
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/to_code.html">
   Ode to code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/sampling_problem.html">
   A sampling problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/three_girls.html">
   A simpler problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/variables_intro.html">
   Introduction to variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Names.html">
   Names and variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Expressions.html">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/functions.html">
   Introduction to functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Calls.html">
   Call expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/first_pass_three_girls.html">
   A first pass at the simple problem
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/data_types.html">
   Types of things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Numbers.html">
   Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Strings.html">
   Strings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/strings_and_variables.html">
   Strings, variables and expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/String_Methods.html">
   String methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Comparison.html">
   Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/lists.html">
   Lists
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Arrays
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/Arrays.html">
   Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/Ranges.html">
   Ranges
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/More_on_Arrays.html">
   More on Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/array_indexing.html">
   Selecting values from an array
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/filling_arrays.html">
   Making and filling arrays.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/function_arguments.html">
   Function arguments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/boolean_arrays.html">
   Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/leaping_ahead.html">
   Leaping ahead
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Iteration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/indentation.html">
   Indentation, indentation, indentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/reply_supreme.html">
   Reply to the Supreme Court
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/inference.html">
   Inference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data frames
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/boolean_indexing.html">
   Indexing with Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/data_frames.html">
   Data frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/data_frame_intro.html">
   Introduction to data frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/df_series_arrays.html">
   Data frames, Series and arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/missing_values.html">
   Missing values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/df_plotting.html">
   Pandas plotting methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Population and permutation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/permutation.html">
   Populations and permutations
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/population_permutation.html">
   Population and permutation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/brexit_ages.html">
   Brexit and ages
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/permutation_idea.html">
   The idea of permutation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/permutation_and_t_test.html">
   Permutation and the t-test
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More building blocks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/more_building_blocks.html">
   More building blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/introducing_functions.html">
   Introducing Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/none.html">
   On None
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/conditional_statements.html">
   Conditional Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/functions_as_values.html">
   Functions as values
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas, indices and labels
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="pandas_indexing.html">
   Indexing in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="noble_politics.html">
   Noble politics and comparing counts
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Handling Pandas safely
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="text_encoding.html">
   Storing and loading text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="numbers_and_strings.html">
   Numbers and strings
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The mean and straight lines
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean.html">
   The mean
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean_meaning.html">
   The meaning of the mean
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/where_and_argmin.html">
   Where and argmin
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean_and_slopes.html">
   The mean and slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/optimization.html">
   Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/where_2d.html">
   Where in 2D
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../mean-slopes/finding_lines.html">
   Finding lines
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../mean-slopes/Lines_Slopes_and_Intercepts_-_Refresher.html">
     Lines, Slopes and Intercepts - Refresher
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/using_minimize.html">
   Using minimize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/inference_on_slopes.html">
   Inference on slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/combining_boolean_arrays.html">
   Combining boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/standard_scores.html">
   Standard scores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/Correlation.html">
   Correlation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Classification
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/classification.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Nearest_Neighbors.html">
   Nearest neighbors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Training_and_Testing.html">
   Training and testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Rows_of_Tables.html">
   Rows of tables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Implementing_the_Classifier.html">
   Implementing the classifier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Accuracy_of_the_Classifier.html">
   Accuracy of the classifier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/Multiple_Regression.html">
   Multiple regression
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../classification/single_multiple.html">
   Simple and multiple regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Useful pandas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/crosstab.html">
   Cross-tabulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/groupby.html">
   The power of groupby
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/merge.html">
   Merging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More on regression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../more-regression/logistic_regression.html">
   Logistic regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Confidence
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/confidence.html">
   On confidence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bootstrap.html">
   The Bootstrap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/havana_math.html">
   A problem for the education minister
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/Central_Limit_Theorem.html">
   The Central Limit Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/random_choice.html">
   Random choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/large_numbers.html">
   The law of large numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/laws_of_probability.html">
   Laws of probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/first_bayes.html">
   First Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_theorem.html">
   Bayes theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_bars.html">
   Bayes and bars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/confident_treatment.html">
   Confident treatment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_confidence.html">
   Bayes, confidence
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The end of the beginning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../end/end_of_beginning.html">
   The end of the beginning
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/uob-ds/cfd2022/main?urlpath=tree/wild-pandas/safe_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/uob-ds/cfd2022/blob/main/wild-pandas/safe_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fuob-ds%2Fcfd2022%2Fblob%2Fmain%2Fwild-pandas/safe_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Deepnote"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_deepnote.svg">
  </span>
<span class="headerbtn__text-container">Deepnote</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/uob-ds/cfd2022"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/uob-ds/cfd2022/issues/new?title=Issue%20on%20page%20%2Fwild-pandas/safe_pandas.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/uob-ds/cfd2022/edit/main/wild-pandas/safe_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/wild-pandas/safe_pandas.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copies-and-views">
   Copies and views
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-1-copy-right">
   Rule 1: copy right.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copies-views-confusing-warnings">
   Copies, views, confusing, warnings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-2-make-errors-for-copy-view-warnings">
   Rule 2: make errors for copy/view warnings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copy-views-on-the-left">
   Copy, views, on the left
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-3-loc-left">
   Rule 3: loc left
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#keep-calm-follow-the-three-rules">
   Keep calm, follow the three rules
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Handling Pandas safely</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copies-and-views">
   Copies and views
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-1-copy-right">
   Rule 1: copy right.
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copies-views-confusing-warnings">
   Copies, views, confusing, warnings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-2-make-errors-for-copy-view-warnings">
   Rule 2: make errors for copy/view warnings
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#copy-views-on-the-left">
   Copy, views, on the left
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#rule-3-loc-left">
   Rule 3: loc left
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#keep-calm-follow-the-three-rules">
   Keep calm, follow the three rules
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="handling-pandas-safely">
<h1>Handling Pandas safely<a class="headerlink" href="#handling-pandas-safely" title="Permalink to this headline">#</a></h1>
<p>A lot of Pandas’ design is for speed and efficiency.</p>
<p>Unfortunately, this sometimes means that is it easy to use Pandas incorrectly, and so get results that you do not expect.</p>
<p>This page has some rules we suggest you follow to stay out of trouble when using Pandas.</p>
<p>As your understanding increases, you may find that you can relax some of these
rules, but the problems in this page can trip up experts, so please, be very
careful, and only relax these rules when you are very confident you understand
the underlying problems.  See <a class="reference internal" href="gory_pandas.html"><span class="doc std std-doc">Gory Pandas</span></a> for a short walk through some of the complexities.</p>
<section id="copies-and-views">
<h2>Copies and views<a class="headerlink" href="#copies-and-views" title="Permalink to this headline">#</a></h2>
<p>Consider this data frame, which should be familiar. It is a table where the
rows are course subjects and the columns include average ratings for all
University professors / lecturers teaching that subject. See <a class="reference internal" href="../data/rate_my_professors.html"><span class="doc std std-doc">the dataset
page</span></a> for more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;rate_my_course.csv&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Discipline</th>
      <th>Number of Professors</th>
      <th>Clarity</th>
      <th>Helpfulness</th>
      <th>Overall Quality</th>
      <th>Easiness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>English</td>
      <td>23343</td>
      <td>3.756147</td>
      <td>3.821866</td>
      <td>3.791364</td>
      <td>3.162754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mathematics</td>
      <td>22394</td>
      <td>3.487379</td>
      <td>3.641526</td>
      <td>3.566867</td>
      <td>3.063322</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Biology</td>
      <td>11774</td>
      <td>3.608331</td>
      <td>3.701530</td>
      <td>3.657641</td>
      <td>2.710459</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Psychology</td>
      <td>11179</td>
      <td>3.909520</td>
      <td>3.887536</td>
      <td>3.900949</td>
      <td>3.316210</td>
    </tr>
    <tr>
      <th>4</th>
      <td>History</td>
      <td>11145</td>
      <td>3.788818</td>
      <td>3.753642</td>
      <td>3.773746</td>
      <td>3.053803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Now imagine that we have discovered that the rating for ‘Clarity’ in the first row is incorrect; it should be 4.0.</p>
<p>We get ready to make a new, fixed copy of the data frame, to store the modified
values.  We put the ‘Disciplines’ column into the data frame to start with.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fixed_ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>
<span class="n">fixed_ratings</span><span class="p">[</span><span class="s1">&#39;Discipline&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;Discipline&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Our next obvious step is to get the ‘Clarity’ column as a Pandas Series, for us
to work on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clarity</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span>
<span class="n">clarity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    3.756147
1    3.487379
2    3.608331
3    3.909520
4    3.788818
Name: Clarity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We set the corrected first value:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">clarity</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">clarity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/_7/h5j1wn6n2b5c2qwh5dtr3jlm0000gq/T/ipykernel_94748/2043106859.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  clarity.iloc[0] = 4
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    4.000000
1    3.487379
2    3.608331
3    3.909520
4    3.788818
Name: Clarity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Notice the warning.  We will come back to that soon.</p>
<p>Notice too that we have changed the value in the <code class="docutils literal notranslate"><span class="pre">clarity</span></code> Series.</p>
<p>Consider — <strong>what happens to the matching value in the original data frame</strong>?</p>
<p>To answer that question, we need to know what kind of thing our <code class="docutils literal notranslate"><span class="pre">clarity</span></code> Series was.</p>
<p><code class="docutils literal notranslate"><span class="pre">clarity</span></code> could be a <em>view</em> onto the ‘Clarity’ column in the original data
frame <code class="docutils literal notranslate"><span class="pre">ratings</span></code>.  A view is something that points to the <em>same memory</em>.  When
we have a view, the view is another way of looking at the <em>same data</em>.  If we
modify the data in the view, that means we also modify the original data frame,
because the <em>data is the same</em>.</p>
<p><code class="docutils literal notranslate"><span class="pre">clarity</span></code> could also be <em>copy</em> of the ‘Clarity’ column. A copy duplicates the
values from the original data.  Therefore a copy has its own values, and its
own memory.  Changing the data in the copy will have no effect on the original
data frame, because the <em>data is different</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Discipline</th>
      <th>Number of Professors</th>
      <th>Clarity</th>
      <th>Helpfulness</th>
      <th>Overall Quality</th>
      <th>Easiness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>English</td>
      <td>23343</td>
      <td>4.000000</td>
      <td>3.821866</td>
      <td>3.791364</td>
      <td>3.162754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mathematics</td>
      <td>22394</td>
      <td>3.487379</td>
      <td>3.641526</td>
      <td>3.566867</td>
      <td>3.063322</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Biology</td>
      <td>11774</td>
      <td>3.608331</td>
      <td>3.701530</td>
      <td>3.657641</td>
      <td>2.710459</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Psychology</td>
      <td>11179</td>
      <td>3.909520</td>
      <td>3.887536</td>
      <td>3.900949</td>
      <td>3.316210</td>
    </tr>
    <tr>
      <th>4</th>
      <td>History</td>
      <td>11145</td>
      <td>3.788818</td>
      <td>3.753642</td>
      <td>3.773746</td>
      <td>3.053803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We have found that the <code class="docutils literal notranslate"><span class="pre">clarity</span></code> Series was a <em>view</em>, because the change we made to <code class="docutils literal notranslate"><span class="pre">clarity</span></code> also changed the value in the original data frame.</p>
<p>This may not be what you expected, and it is probably not what you meant to do.</p>
<p>This leads to the first rule for safe handling of Pandas.</p>
</section>
<section id="rule-1-copy-right">
<h2>Rule 1: copy right.<a class="headerlink" href="#rule-1-copy-right" title="Permalink to this headline">#</a></h2>
<p>We strongly suggest that when you get stuff out of a Pandas data frame or
Series by indexing, you always make what you have into a copy.</p>
<p>We call this rule <em>copy right</em>.</p>
<p>As a reminder <em>indexing</em> is where we fetch data from something using square
brackets.  Indexing can be: <em>direct</em>, with the square brackets directly
following the data frame or Series; or <em>indirect</em>, where the square brackets
follow the <code class="docutils literal notranslate"><span class="pre">.loc</span></code> or <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> attributes of the data frame or Series.</p>
<p>For example, we have just used direct indexing (square brackets) to fetch the
‘Clarity’ data out of the <code class="docutils literal notranslate"><span class="pre">ratings</span></code> data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Indexing to fetch a Series from a data frame.</span>
<span class="n">clarity</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>We found that <code class="docutils literal notranslate"><span class="pre">clarity</span></code> is a <em>view</em> onto the ‘Clarity’ data in <code class="docutils literal notranslate"><span class="pre">ratings</span></code>.   This is rarely what we want.</p>
<p>Here we apply the <em>copy right</em> rule:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Applying the &quot;copy right&quot; rule.</span>
<span class="n">clearer_clarity</span> <span class="o">=</span> <span class="n">ratings</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Notice we apply the <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> method to the ‘Clarity’ Series, so forcing Pandas to make us a copy of the data.</p>
<p>Now we have done that, we can modify the result without affecting the original data frame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Modify the copy with some crazy value.</span>
<span class="n">clearer_clarity</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
<span class="n">clearer_clarity</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    99.000000
1     3.487379
2     3.608331
3     3.909520
4     3.788818
Name: Clarity, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>This does not affect the original data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Discipline</th>
      <th>Number of Professors</th>
      <th>Clarity</th>
      <th>Helpfulness</th>
      <th>Overall Quality</th>
      <th>Easiness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>English</td>
      <td>23343</td>
      <td>4.000000</td>
      <td>3.821866</td>
      <td>3.791364</td>
      <td>3.162754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mathematics</td>
      <td>22394</td>
      <td>3.487379</td>
      <td>3.641526</td>
      <td>3.566867</td>
      <td>3.063322</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Biology</td>
      <td>11774</td>
      <td>3.608331</td>
      <td>3.701530</td>
      <td>3.657641</td>
      <td>2.710459</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Psychology</td>
      <td>11179</td>
      <td>3.909520</td>
      <td>3.887536</td>
      <td>3.900949</td>
      <td>3.316210</td>
    </tr>
    <tr>
      <th>4</th>
      <td>History</td>
      <td>11145</td>
      <td>3.788818</td>
      <td>3.753642</td>
      <td>3.773746</td>
      <td>3.053803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="copies-views-confusing-warnings">
<h2>Copies, views, confusing, warnings<a class="headerlink" href="#copies-views-confusing-warnings" title="Permalink to this headline">#</a></h2>
<p>It can be very difficult to predict when Pandas indexing will give a copy or a view.</p>
<p>For example, here we use indirect indexing (square brackets following <code class="docutils literal notranslate"><span class="pre">.loc</span></code>)
to select the row of <code class="docutils literal notranslate"><span class="pre">ratings</span></code> with index label 0.  Remember <code class="docutils literal notranslate"><span class="pre">.loc</span></code> indexing
uses the <em>index labels</em>, not <em>positions</em>, although in this case the index has
label 0 for position 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_0</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">row_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Discipline               English
Number of Professors       23343
Clarity                      4.0
Helpfulness             3.821866
Overall Quality         3.791364
Easiness                3.162754
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>We saw earlier that direct indexing to select a column ‘Clarity’ gave us
a view, meaning that we could change the values in the data frame by changing
the Series <code class="docutils literal notranslate"><span class="pre">clarity</span></code> we got from indexing.  In fact this is also true if we use indirect indexing with <code class="docutils literal notranslate"><span class="pre">.loc</span></code> or <code class="docutils literal notranslate"><span class="pre">.iloc</span></code>.  Check this by trying <code class="docutils literal notranslate"><span class="pre">clarity</span> <span class="pre">=</span> <span class="pre">ratings.loc[:,</span> <span class="pre">'Clarity']</span></code> in the code above.</p>
<p>We have just fetched the row labeled 0 using <code class="docutils literal notranslate"><span class="pre">.loc</span></code>.  Given what we know about
fetching a column, it would be reasonable to predict this would give us a view.</p>
<p>Does it give a view?  Or a copy?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Changing the &#39;Clarity&#39; value of the first row.</span>
<span class="n">row_0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">row_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/var/folders/_7/h5j1wn6n2b5c2qwh5dtr3jlm0000gq/T/ipykernel_94748/3112591213.py:2: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  row_0.loc[&#39;Clarity&#39;] = 5
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Discipline               English
Number of Professors       23343
Clarity                        5
Helpfulness             3.821866
Overall Quality         3.791364
Easiness                3.162754
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Notice the warning, again.</p>
<p>But - this time - did we change the original data frame?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Discipline</th>
      <th>Number of Professors</th>
      <th>Clarity</th>
      <th>Helpfulness</th>
      <th>Overall Quality</th>
      <th>Easiness</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>English</td>
      <td>23343</td>
      <td>4.000000</td>
      <td>3.821866</td>
      <td>3.791364</td>
      <td>3.162754</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Mathematics</td>
      <td>22394</td>
      <td>3.487379</td>
      <td>3.641526</td>
      <td>3.566867</td>
      <td>3.063322</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Biology</td>
      <td>11774</td>
      <td>3.608331</td>
      <td>3.701530</td>
      <td>3.657641</td>
      <td>2.710459</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Psychology</td>
      <td>11179</td>
      <td>3.909520</td>
      <td>3.887536</td>
      <td>3.900949</td>
      <td>3.316210</td>
    </tr>
    <tr>
      <th>4</th>
      <td>History</td>
      <td>11145</td>
      <td>3.788818</td>
      <td>3.753642</td>
      <td>3.773746</td>
      <td>3.053803</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>No, we didn’t change the original data frame — and we conclude that
<code class="docutils literal notranslate"><span class="pre">row_0</span></code> is a <em>copy</em>.</p>
<p>Our first, correct, response is to follow the <em>copy right</em> rule, and make this copy explicit, so we know exactly what we have:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The &quot;copy right&quot; rule again.</span>
<span class="n">copied_row_0</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>We no longer have a nasty warning when we modify <code class="docutils literal notranslate"><span class="pre">copied_row_0</span></code>, because
Pandas knows we made a copy, so it does not need to warn us that we may be
making a mistake:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We don&#39;t get a warning when we change the copied result.</span>
<span class="n">copied_row_0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">copied_row_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Discipline               English
Number of Professors       23343
Clarity                        5
Helpfulness             3.821866
Overall Quality         3.791364
Easiness                3.162754
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<p><strong>Please do worry about these warnings</strong>.  In fact, in the interests of safety,
we come to rule 2.</p>
</section>
<section id="rule-2-make-errors-for-copy-view-warnings">
<h2>Rule 2: make errors for copy/view warnings<a class="headerlink" href="#rule-2-make-errors-for-copy-view-warnings" title="Permalink to this headline">#</a></h2>
<p>Pandas has a setting that allows you to change the nasty warning about setting with copies into an error.</p>
<p>We strongly suggest that you do that, for all your notebooks, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.chained_assignment&#39;</span><span class="p">,</span> <span class="s1">&#39;raise&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>After you have done this, Pandas will stop if you try to do something like this:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_0</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># Copy?  Or view?  Difficult to guess.</span>
<span class="c1"># Now this generates an error.</span>
<span class="n">row_0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SettingWithCopyError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">Input In [17],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">row_0</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>   <span class="c1"># Copy?  Or view?  Difficult to guess.</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># Now this generates an error.</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">row_0</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:716,</span> in <span class="ni">_LocationIndexer.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_valid_setitem_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span> <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;iloc&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">iloc</span>
<span class="ne">--&gt; </span><span class="mi">716</span> <span class="n">iloc</span><span class="o">.</span><span class="n">_setitem_with_indexer</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1690,</span> in <span class="ni">_iLocIndexer._setitem_with_indexer</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1688</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_with_indexer_split_path</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1689</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1690</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_single_block</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1935,</span> in <span class="ni">_iLocIndexer._setitem_single_block</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1932</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align_frame</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1934</span> <span class="c1"># check for chained assignment</span>
<span class="ne">-&gt; </span><span class="mi">1935</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1937</span> <span class="c1"># actually do the set</span>
<span class="g g-Whitespace">   </span><span class="mi">1938</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">indexer</span><span class="o">=</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/series.py:1258,</span> in <span class="ni">Series._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>     <span class="k">return</span> <span class="kc">True</span>
<span class="ne">-&gt; </span><span class="mi">1258</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:3945,</span> in <span class="ni">NDFrame._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">3934</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3935</span><span class="sd"> Check if we are a view, have a cacher, and are of mixed type.</span>
<span class="g g-Whitespace">   </span><span class="mi">3936</span><span class="sd"> If so, then force a setitem_copy check.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">3942</span><span class="sd"> setting.</span>
<span class="g g-Whitespace">   </span><span class="mi">3943</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3944</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_copy</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3945</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3946</span> <span class="k">return</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:4016,</span> in <span class="ni">NDFrame._check_setitem_copy</span><span class="nt">(self, t, force)</span>
<span class="g g-Whitespace">   </span><span class="mi">4005</span>     <span class="n">t</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4006</span>         <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4007</span>         <span class="s2">&quot;A value is trying to be set on a copy of a slice from a &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4012</span>         <span class="s2">&quot;indexing.html#returning-a-view-versus-a-copy&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4013</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4015</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4016</span>     <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyError</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4017</span> <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;warn&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4018</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">())</span>

<span class="ne">SettingWithCopyError</span>: 
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">DataFrame</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">user_guide</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#returning-a-view-versus-a-copy</span>
</pre></div>
</div>
</div>
</div>
<p>At first you will find this advice annoying.  Your code will generate confusing
errors, and you will be tempted to remove this error option to make the errors
go away.  Please be patient.  You will find that, if you follow the <em>copy right</em> rule carefully, most of these errors go away.</p>
</section>
<section id="copy-views-on-the-left">
<h2>Copy, views, on the left<a class="headerlink" href="#copy-views-on-the-left" title="Permalink to this headline">#</a></h2>
<p>Now consider this code:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SettingWithCopyError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">Input In [18],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:716,</span> in <span class="ni">_LocationIndexer.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_valid_setitem_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span> <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;iloc&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">iloc</span>
<span class="ne">--&gt; </span><span class="mi">716</span> <span class="n">iloc</span><span class="o">.</span><span class="n">_setitem_with_indexer</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1690,</span> in <span class="ni">_iLocIndexer._setitem_with_indexer</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1688</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_with_indexer_split_path</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1689</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1690</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_single_block</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1935,</span> in <span class="ni">_iLocIndexer._setitem_single_block</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1932</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align_frame</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1934</span> <span class="c1"># check for chained assignment</span>
<span class="ne">-&gt; </span><span class="mi">1935</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1937</span> <span class="c1"># actually do the set</span>
<span class="g g-Whitespace">   </span><span class="mi">1938</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">indexer</span><span class="o">=</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/series.py:1258,</span> in <span class="ni">Series._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>     <span class="k">return</span> <span class="kc">True</span>
<span class="ne">-&gt; </span><span class="mi">1258</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:3945,</span> in <span class="ni">NDFrame._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">3934</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3935</span><span class="sd"> Check if we are a view, have a cacher, and are of mixed type.</span>
<span class="g g-Whitespace">   </span><span class="mi">3936</span><span class="sd"> If so, then force a setitem_copy check.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">3942</span><span class="sd"> setting.</span>
<span class="g g-Whitespace">   </span><span class="mi">3943</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3944</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_copy</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3945</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3946</span> <span class="k">return</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:4016,</span> in <span class="ni">NDFrame._check_setitem_copy</span><span class="nt">(self, t, force)</span>
<span class="g g-Whitespace">   </span><span class="mi">4005</span>     <span class="n">t</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4006</span>         <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4007</span>         <span class="s2">&quot;A value is trying to be set on a copy of a slice from a &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4012</span>         <span class="s2">&quot;indexing.html#returning-a-view-versus-a-copy&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4013</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4015</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4016</span>     <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyError</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4017</span> <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;warn&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4018</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">())</span>

<span class="ne">SettingWithCopyError</span>: 
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">DataFrame</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">user_guide</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#returning-a-view-versus-a-copy</span>
</pre></div>
</div>
</div>
</div>
<p>Because we have set the <code class="docutils literal notranslate"><span class="pre">mode.chained_assignment</span></code> option to <code class="docutils literal notranslate"><span class="pre">error</span></code> above, this generates an error — but why?</p>
<p>The reason is the same as the reason for the previous error.  The code in the
cell directly above is just a short-cut for this exact equivalent.</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SettingWithCopyError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">Input In [19],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">tmp</span> <span class="o">=</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">tmp</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:716,</span> in <span class="ni">_LocationIndexer.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_valid_setitem_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span> <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;iloc&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">iloc</span>
<span class="ne">--&gt; </span><span class="mi">716</span> <span class="n">iloc</span><span class="o">.</span><span class="n">_setitem_with_indexer</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1690,</span> in <span class="ni">_iLocIndexer._setitem_with_indexer</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1688</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_with_indexer_split_path</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1689</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1690</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_single_block</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1935,</span> in <span class="ni">_iLocIndexer._setitem_single_block</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1932</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align_frame</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1934</span> <span class="c1"># check for chained assignment</span>
<span class="ne">-&gt; </span><span class="mi">1935</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1937</span> <span class="c1"># actually do the set</span>
<span class="g g-Whitespace">   </span><span class="mi">1938</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">indexer</span><span class="o">=</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/series.py:1258,</span> in <span class="ni">Series._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>     <span class="k">return</span> <span class="kc">True</span>
<span class="ne">-&gt; </span><span class="mi">1258</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:3945,</span> in <span class="ni">NDFrame._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">3934</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3935</span><span class="sd"> Check if we are a view, have a cacher, and are of mixed type.</span>
<span class="g g-Whitespace">   </span><span class="mi">3936</span><span class="sd"> If so, then force a setitem_copy check.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">3942</span><span class="sd"> setting.</span>
<span class="g g-Whitespace">   </span><span class="mi">3943</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3944</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_copy</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3945</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3946</span> <span class="k">return</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:4016,</span> in <span class="ni">NDFrame._check_setitem_copy</span><span class="nt">(self, t, force)</span>
<span class="g g-Whitespace">   </span><span class="mi">4005</span>     <span class="n">t</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4006</span>         <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4007</span>         <span class="s2">&quot;A value is trying to be set on a copy of a slice from a &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4012</span>         <span class="s2">&quot;indexing.html#returning-a-view-versus-a-copy&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4013</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4015</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4016</span>     <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyError</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4017</span> <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;warn&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4018</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">())</span>

<span class="ne">SettingWithCopyError</span>: 
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">DataFrame</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">user_guide</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#returning-a-view-versus-a-copy</span>
</pre></div>
</div>
</div>
</div>
<p>Specifically, when Python sees <code class="docutils literal notranslate"><span class="pre">ratings.loc[0].loc['Clarity']</span> <span class="pre">=</span> <span class="pre">99</span></code>, it first
evaluates <code class="docutils literal notranslate"><span class="pre">ratings.loc[0]</span></code> to generate a temporary copy.  In the code above, we
called this temporary copy <code class="docutils literal notranslate"><span class="pre">tmp</span></code>. It then tries to set the value into the copy
with <code class="docutils literal notranslate"><span class="pre">tmp.loc['Clarity']</span> <span class="pre">=</span> <span class="pre">99</span></code>.  This generates the same error as you saw
before.</p>
<p>As you have probably guessed from the option name above, Pandas calls this
<em>chained assignment</em>, because you are: first, fetching the stuff you want do
the assignment on (<code class="docutils literal notranslate"><span class="pre">ratings.loc[0]</span></code>) and then doing the assignment
<code class="docutils literal notranslate"><span class="pre">.loc['Clarity']</span> <span class="pre">=</span> <span class="pre">99</span></code>. There are two steps on the left hand side, in a chain,
first fetching the data, then assigning.</p>
<p>The problem that Pandas has is that it cannot tell that this chained assignment
has happened, so it can’t tell what you mean.  Python will ask Pandas to
generate <code class="docutils literal notranslate"><span class="pre">ratings.loc[0]</span></code> first, which it does, to generate the temporary copy
that we can call <code class="docutils literal notranslate"><span class="pre">tmp</span></code>. Python then ask Pandas to set the value with
<code class="docutils literal notranslate"><span class="pre">tmp.loc['Clarity']</span> <span class="pre">=</span> <span class="pre">99</span></code>.  When Pandas gets this second instruction, it has no
way of knowing that <code class="docutils literal notranslate"><span class="pre">tmp</span></code> came from the combined instruction
<code class="docutils literal notranslate"><span class="pre">ratings.loc[0].loc['Clarity']</span> <span class="pre">=</span> <span class="pre">99</span></code>, and so all it can do is set the value
into the copy, as instructed.</p>
<p>This leads us to the last rule.</p>
</section>
<section id="rule-3-loc-left">
<h2>Rule 3: loc left<a class="headerlink" href="#rule-3-loc-left" title="Permalink to this headline">#</a></h2>
<p>When you do want to use indexing on the left hand side, to set some values into
a data frame or Series, try do to this all in one shot, using indirect indexing
with <code class="docutils literal notranslate"><span class="pre">.loc</span></code> or <code class="docutils literal notranslate"><span class="pre">iloc</span></code>.</p>
<p>For example, you have just see that this generates an error, and why:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SettingWithCopyError</span><span class="g g-Whitespace">                      </span>Traceback (most recent call last)
<span class="nn">Input In [20],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:716,</span> in <span class="ni">_LocationIndexer.__setitem__</span><span class="nt">(self, key, value)</span>
<span class="g g-Whitespace">    </span><span class="mi">713</span> <span class="bp">self</span><span class="o">.</span><span class="n">_has_valid_setitem_indexer</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">715</span> <span class="n">iloc</span> <span class="o">=</span> <span class="bp">self</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;iloc&quot;</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">iloc</span>
<span class="ne">--&gt; </span><span class="mi">716</span> <span class="n">iloc</span><span class="o">.</span><span class="n">_setitem_with_indexer</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1690,</span> in <span class="ni">_iLocIndexer._setitem_with_indexer</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1688</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_with_indexer_split_path</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1689</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">1690</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_setitem_single_block</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/indexing.py:1935,</span> in <span class="ni">_iLocIndexer._setitem_single_block</span><span class="nt">(self, indexer, value, name)</span>
<span class="g g-Whitespace">   </span><span class="mi">1932</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_align_frame</span><span class="p">(</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1934</span> <span class="c1"># check for chained assignment</span>
<span class="ne">-&gt; </span><span class="mi">1935</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1937</span> <span class="c1"># actually do the set</span>
<span class="g g-Whitespace">   </span><span class="mi">1938</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obj</span><span class="o">.</span><span class="n">_mgr</span><span class="o">.</span><span class="n">setitem</span><span class="p">(</span><span class="n">indexer</span><span class="o">=</span><span class="n">indexer</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">)</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/series.py:1258,</span> in <span class="ni">Series._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1257</span>     <span class="k">return</span> <span class="kc">True</span>
<span class="ne">-&gt; </span><span class="mi">1258</span> <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">_check_is_chained_assignment_possible</span><span class="p">()</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:3945,</span> in <span class="ni">NDFrame._check_is_chained_assignment_possible</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">3934</span> <span class="sd">&quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3935</span><span class="sd"> Check if we are a view, have a cacher, and are of mixed type.</span>
<span class="g g-Whitespace">   </span><span class="mi">3936</span><span class="sd"> If so, then force a setitem_copy check.</span>
<span class="sd">   (...)</span>
<span class="g g-Whitespace">   </span><span class="mi">3942</span><span class="sd"> setting.</span>
<span class="g g-Whitespace">   </span><span class="mi">3943</span><span class="sd"> &quot;&quot;&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">3944</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_copy</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">3945</span>     <span class="bp">self</span><span class="o">.</span><span class="n">_check_setitem_copy</span><span class="p">(</span><span class="n">t</span><span class="o">=</span><span class="s2">&quot;referent&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">3946</span> <span class="k">return</span> <span class="kc">False</span>

<span class="nn">File ~/miniconda3/envs/cfd2022Env/lib/python3.10/site-packages/pandas/core/generic.py:4016,</span> in <span class="ni">NDFrame._check_setitem_copy</span><span class="nt">(self, t, force)</span>
<span class="g g-Whitespace">   </span><span class="mi">4005</span>     <span class="n">t</span> <span class="o">=</span> <span class="p">(</span>
<span class="g g-Whitespace">   </span><span class="mi">4006</span>         <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4007</span>         <span class="s2">&quot;A value is trying to be set on a copy of a slice from a &quot;</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4012</span>         <span class="s2">&quot;indexing.html#returning-a-view-versus-a-copy&quot;</span>
<span class="g g-Whitespace">   </span><span class="mi">4013</span>     <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4015</span> <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
<span class="ne">-&gt; </span><span class="mi">4016</span>     <span class="k">raise</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyError</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">4017</span> <span class="k">elif</span> <span class="n">value</span> <span class="o">==</span> <span class="s2">&quot;warn&quot;</span><span class="p">:</span>
<span class="g g-Whitespace">   </span><span class="mi">4018</span>     <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">com</span><span class="o">.</span><span class="n">SettingWithCopyWarning</span><span class="p">,</span> <span class="n">stacklevel</span><span class="o">=</span><span class="n">find_stack_level</span><span class="p">())</span>

<span class="ne">SettingWithCopyError</span>: 
<span class="n">A</span> <span class="n">value</span> <span class="ow">is</span> <span class="n">trying</span> <span class="n">to</span> <span class="n">be</span> <span class="nb">set</span> <span class="n">on</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">a</span> <span class="nb">slice</span> <span class="kn">from</span> <span class="nn">a</span> <span class="n">DataFrame</span>

<span class="n">See</span> <span class="n">the</span> <span class="n">caveats</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">documentation</span><span class="p">:</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandas</span><span class="o">.</span><span class="n">pydata</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">pandas</span><span class="o">-</span><span class="n">docs</span><span class="o">/</span><span class="n">stable</span><span class="o">/</span><span class="n">user_guide</span><span class="o">/</span><span class="n">indexing</span><span class="o">.</span><span class="n">html</span><span class="c1">#returning-a-view-versus-a-copy</span>
</pre></div>
</div>
</div>
</div>
<p>You can avoid that error by doing all your left-hand-side indexing in one shot, like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ratings</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Clarity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
</div>
</div>
<p>Notice there is no error.  This is because, in this second case, Pandas gets
all the instructions in one go.  It can see from this combined instruction that
we <em>meant</em> to set the ‘Clarity’ value for the row labeled 0 in the <code class="docutils literal notranslate"><span class="pre">ratings</span></code>
data frame, and does just this.</p>
</section>
<section id="keep-calm-follow-the-three-rules">
<h2>Keep calm, follow the three rules<a class="headerlink" href="#keep-calm-follow-the-three-rules" title="Permalink to this headline">#</a></h2>
<p>Do not worry if some of this is not immediately clear; it is not easy.</p>
<p>The trick is to remember the three rules:</p>
<ul class="simple">
<li><p>Copy right.</p></li>
<li><p>Make copy warnings into errors.</p></li>
<li><p>Use <code class="docutils literal notranslate"><span class="pre">.loc</span></code> and <code class="docutils literal notranslate"><span class="pre">.iloc</span></code> for your left-hand-side indexing.</p></li>
</ul>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "uob-ds/cfd2022",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./wild-pandas"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="noble_politics.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Noble politics and comparing counts</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="text_encoding.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Storing and loading text</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Matthew Brett, Ani Adhikari, John Denero, David Wagner, Peter Rush<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>